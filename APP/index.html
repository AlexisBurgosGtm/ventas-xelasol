<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <link rel="apple-touch-icon" sizes="76x76" href="./assets/img/apple-icon.png">
    <link rel="icon" type="image/png" href="./assets/img/favicon.png">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>Express-online</title>
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
    
    <!--     Fonts and icons     -->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,200" rel="stylesheet" />
    <link href="https://use.fontawesome.com/releases/v5.0.6/css/all.css" rel="stylesheet">
    
    <!-- CSS Files 
    <link href="./assets/css/now-ui-dashboard.css?v=1.0.1" rel="stylesheet" />
    -->
    <link href="./assets/css/bootstrap.min.css" rel="stylesheet" />
    <link href="./assets/css/now-ui-dashboard.min.css" rel="stylesheet" />
    <link href="./assets/css/now-ui-dashboard.css" rel="stylesheet" />
    <link href="./assets/css/all.css" rel="stylesheet" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous"/>
    <link rel="stylesheet" href="./assets/css/btn.css">
    <link rel="stylesheet" href="./assets/css/themify-icons.css">

    <!-- libreria Leaflet para control de OpenStreethMap -->
    <link rel="stylesheet" href="./onlineLibrary/leaflet/leaflet.css" />

     <!-- service worker -->
     <meta name="application-name" content="Express-Online" />
     <meta name="theme-color" content="#ffffff">
     <link rel="manifest" href="manifest.json">
</head>

<body class="" id="up">
    <div class="wrapper">
        <div class="sidebar fixed-top" data-color="purple">
            <div class="sidebar-wrapper">
                
                <div class="">
                    <img src="./assets/img/FONDO.jpg">
                </div>
                
                <ul class="nav" id="navbar-general">

                    <li>
                        <a href="#" id="btnDashboard">
                            <i class="now-ui-icons design_app"></i>
                            <p>Noticias</p>
                        </a>
                    </li>
                                                            
                    <li>
                        <a href="#" id="btnVentas">
                            <i class="now-ui-icons shopping_cart-simple"></i>
                            <p>Ventas</p>
                        </a>
                    </li>
                    <li>
                        <a href="#" id="btnMapas">
                            <i class="now-ui-icons location_map-big"></i>
                            <p>Recorrido Ventas</p>
                        </a>
                    </li>
                                                            
                    <li>
                        <a href="#" id="btnCenso">
                            <i class="now-ui-icons location_map-big"></i>
                            <p>Censo</p>
                        </a>
                    </li>

                    <li>
                        <a href="#" id="btnPrecios">
                            <i class="now-ui-icons design_bullet-list-67"></i>
                            <p>Precios</p>
                        </a>
                    </li>
                    <li>
                        <a href="#" id="btnTools">
                            <i class="now-ui-icons ui-2_settings-90"></i>
                            <p>Herramientas</p>
                        </a>
                    </li>
                    <li>
                        <a href="#" id="btnReportes">
                            <i class="now-ui-icons ui-2_settings-90"></i>
                            <p>Reportes</p>
                        </a>
                    </li>
                    <li>
                        <a href="#" id="btnClientes">
                            <i class="now-ui-icons ui-1_bell-53"></i>
                            <p>Clientes</p>
                        </a>
                    </li>
                    <li>
                        <a href="#" id="btnConfig">
                            <i class="now-ui-icons loader_gear"></i>
                            <p>Config</p>
                        </a>
                    </li>
                    <li>
                        <a href="index.html" id="btnSalir">
                            <i class="now-ui-icons users_single-02"></i>
                            <p>Salir(x)</p>
                        </a>
                    </li>

                    <li>
                        <a href="#" id="btnChat">
                            <!--<i class="now-ui-icons loader_gear"></i>
                            <p>Chat</p>-->
                        </a>
                    </li>
               
                </ul>
            </div>
        </div>

        <!--
        <div class="panel-header panel-header-sm">
        </div>
        -->
        <div class="main-panel body-bg-primary">
            <!-- Navbar -->
            <nav class="navbar navbar-expand-lg bg-purple fixed-top ">
                <div class="container-fluid">
                    <div class="navbar-wrapper">
                        <div class="navbar-toggle">
                            <button type="button" class="navbar-toggler" id="btnToggler">
                                <span class="navbar-toggler-bar bar1"></span>
                                <span class="navbar-toggler-bar bar2"></span>
                                <span class="navbar-toggler-bar bar3"></span>
                            </button>
                        </div>
                        <a class="navbar-brand" href="#">Express-POS</a>
                    </div>
                </div>
                
                <a href="#up" class="simplescrollup__button simplescrollup__button--hide btn-circle btn-icon">
                    <i class="now-ui-icons arrows-1_minimal-up"></i>
                </a>
           </nav>
            <!-- End Navbar -->
            <div class="content">
                <!--espacio-->
                <h1>.</h1>
                <h6> </h6>
                <div class="row" id="contenedor">
                    
                </div>
            </div>


        <!-- Modal para Calculo de Precio de Venta//margen -->
        <div class="modal fade" id="ModalCalcularMargen" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                        <div class="modal-header">
                            <label class="modal-title">Cálculo de Margen de Venta</label>
                        </div>
                    <div class="modal-body">
                        <div class="col-8">
                                                    
                            <div class="form-group">
                                <label>Costo: </label>
                                <input type="number" class="form-control" id="txtCosto" value="0">
                            </div>
                            <div class="form-group">
                                <label>Margen: </label>
                                <input type="number" class="form-control" id="txtMargen" value="20">
                            </div>
                            
                            <div class="form-group">
                                    <label>Precio de Venta: </label>
                                    <h4 class="text-primary" id="txtCalcularResult">Q 0.00</h4>
                            </div>
                        </div>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary btn-round" data-dismiss="modal">
                            <i class="now-ui-icons ui-1_simple-remove"></i>
                            Cancelar
                        </button>
                        <button type="button" class="btn btn-primary btn-round" id="btnCalcularMargen">
                            
                            Calcular
                        </button>
                    </div>
                </div>
            </div>
        </div>

            
            <footer class="footer">
                <div class="container-fluid">
                    <div class="copyright">
                        &copy;
                        <script>
                            document.write(new Date().getFullYear())
                        </script>, <a class="text-warning" href="https://api.whatsapp.com/send?phone=50257255092&text=Hola,%20me%20interesa%20este%20sistema%20(Express-Pos)">Desarrollado por Alexis Burgos (AlexisBurgosGtm@gmail.com)</a>
                    </div>
                </div>
            </footer>
            

        </div>
    </div>
<!-- botón subir <a href="#up" class="simplescrollup__button simplescrollup__button--hide"> 
<a href="#up" class="simplescrollup__button simplescrollup__button--hide btn-circle btn-icon">
    <i class="now-ui-icons arrows-1_minimal-up"></i>
</a>
-->
   

<script src="./controllers/simplescrollup.js"></script>

</body>
<!--   Core JS Files   -->
<script src="./assets/js/core/jquery.min.js"></script>
<script src="./assets/js/core/popper.min.js"></script>
<script src="./assets/js/core/bootstrap.min.js"></script>
<script src="./assets/js/plugins/perfect-scrollbar.jquery.min.js"></script>

<!--  Notifications Plugin    -->
<script src="./assets/js/plugins/bootstrap-notify.js"></script>
<!-- Control Center for Now Ui Dashboard: parallax effects, scripts for the example pages etc -->
<!--<script src="./assets/js/now-ui-dashboard.js?v=1.0.1"></script>-->
<script src="./assets/js/now-ui-dashboard.js"></script>

<!--Librerías varias-->
<script src="./controllers/GlobalVars.js"></script>

<script src="./assets/js/sweetalert.min.js"></script> <!--alertas varias-->
<script src="./assets/js/JsStore.min.js"></script> <!-- para trabajar con IndexDb-->
<script src="./controllers/funciones.js"></script>
<script src="./onlineLibrary/leaflet/leaflet.js"></script> <!--  -->

<script src="./controllers/database.js"></script>

<!-- controladores -->
<script src="./controllers/classDbOp.js"></script>
<script src="./controllers/inicio.js"></script>
<script async src="./controllers/dataventas.js"></script>
<script async src="./controllers/precios.js"></script>
<script async src="./controllers/clientes.js"></script>
<script async src="./controllers/ventas.js"></script>
<script async src="./controllers/classCenso.js"></script>
<script async src="./controllers/tools.js"></script>
<script async src="./controllers/classEnvios.js"></script>
<script async src="./controllers/index.js"></script>
<script async src="./controllers/config.js"></script>
<script async src="./controllers/sync.js"></script>
<script async src="./controllers/classAdmin.js"></script>

<!--<script src="./onlineLibrary/socket.io.js"></script>-->

<script>
    //inicializa el token
    if ('serviceWorker' in navigator) {
            window.addEventListener('load', () =>
           navigator.serviceWorker.register('sw.js')
            .then(registration => console.log('Service Worker registered'))
            .catch(err => 'SW registration failed'));
    };

  //carga la vista de login
   funciones.loadView('./views/viewLogin.html')
        .then(async ()=>{
            ControllerMenu('LOGIN');
        })

    //const socket = io();   

   async function CargarComboEmpresas(){
    console.log('antes de cargar empresas: ' + GlobalToken);
            //carga la lista de empresas en el combobox
            try {
                const response = await fetch(`${GlobalServerUrl}/api/empresas/all?token=${GlobalToken}`)
                const json = await response.json();
                let comboboxemp = document.getElementById('cmbEmpresas')

                comboboxemp.innerHTML = ''
                comboboxemp.innerHTML = json.recordset.map((empresa)=>{
                return `<option value="${empresa.EMPNIT}">${empresa.EMPNOMBRE}</option>`;        
               }).join('\n');
   
            } catch (error) {
                console.log(error);
                funciones.AvisoError('No se pudo cargar la lista de empresas');
            }
   }

   let btnCalcularMargen = document.getElementById('btnCalcularMargen')
   btnCalcularMargen.addEventListener('click',()=>{
       try {
           let toolCosto = parseFloat(document.getElementById('txtCosto').value) || 0;
           let toolMargen = parseFloat(document.getElementById('txtMargen').value) || 0;
           let toolResult = document.getElementById('txtCalcularResult');
            var toolPrecio = funciones.setMoneda(toolCosto * ((toolMargen/100)+1),'Q ')
            toolResult.innerText = toolPrecio;
       } catch (error) {
           funciones.AvisoError('Algo pasó y no se pudo calcular el precio de Venta')
       }
   })

</script>

<!--
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.2.0/socket.io.js"></script>
-->

<script>
   
 /*   
async function CargarFuncionesChat () {
       
        //var socket = io.connect('http://localhost:5000');
        //var socket = io();
                      
        document.getElementById('btnEnviar').addEventListener('click',()=>{
            socket.emit('chat message', $('#m').val(), GlobalUser);
            $('#m').val('');
        })

        socket.on('chat message', function(msg,user){
            $('#messages').append($('<li>').text(user));
          $('#messages').append($('<li>').text(msg));
          window.scrollTo(0, document.body.scrollHeight);
        });
     
    };
    */
</script>

<!--  Google Maps Plugin    -->
<script src="https://maps.googleapis.com/maps/api/js?key=YOUR_KEY_HERE"></script>

</html>
